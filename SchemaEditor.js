(globalThis.webpackChunkjson_schema_pouchdb_app=globalThis.webpackChunkjson_schema_pouchdb_app||[]).push([[962],{40006:(e,t,a)=>{"use strict";a.r(t),a.d(t,{SchemaEditor:()=>g,default:()=>Z});var s=a(67294),n=a(74981),l=(a(90252),a(61970),a(17233)),r=a(89659),i=a(41749),c=a(282),m=a(64330),h=a(22318),o=a(78715),d=a(16550),u=a(73727),p=a(47398),E=a(29958);function v(e){return JSON.stringify(e,null,"  ")}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class g extends s.Component{constructor(...e){super(...e),b(this,"state",{loaded:!1,title:"",schema:{},value:v({}),error:null}),b(this,"updateTitle",(e=>{const{value:t}=e.target;this.setState({title:t},(()=>this.save()))})),b(this,"updateSchema",(async(e,t,a)=>{if(this.setState({value:e}),""!==e.trim())try{const t=JSON.parse(e);await this.save(),this.setState({error:null,schema:t},(()=>this.save()))}catch(e){console.warn(e)}})),b(this,"save",(async()=>{const e=this.getId();await this.props.db.saveSchema(e,this.state.title,this.state.schema)}))}getId(){const{id:e}=this.props.match.params;return e}async componentDidMount(){const{title:e,schema:t}=await this.props.db.getSchema(this.getId());this.setState({loaded:!0,title:e,schema:t,value:v(t)})}render(){const{loaded:e,title:t,value:a,schema:d,error:v}=this.state;return e?s.createElement(s.Fragment,null,s.createElement(E.Z,{title:`Edit ${t}`}),s.createElement(h.Z,{variant:"h3",component:"h1"},"Edit ",t),s.createElement("p",null,s.createElement(r.Z,{component:u.rU,to:"/","data-testid":"return-to-schema-list"},"Return to Schema List")),s.createElement(i.Z,{container:!0,spacing:2},s.createElement(i.Z,{item:!0,xs:!0},s.createElement(m.Z,{fullWidth:!0,id:"schema-name",label:"Schema Name",onChange:this.updateTitle,value:t,size:"small",variant:"outlined","data-testid":"schema-name"}),s.createElement(p.Z,null),v&&s.createElement(s.Fragment,null,s.createElement(o.Z,{severity:"error","data-testid":"schema-error"},v),s.createElement(p.Z,null)),s.createElement(n.ZP,{onChange:this.updateSchema,value:a,width:"100%",mode:"json",theme:"twilight","data-testid":"schema-editor"}),s.createElement(p.Z,null)),s.createElement(i.Z,{item:!0,xs:!0},s.createElement(l.ZP,{disabled:!0,schema:d,"data-testid":"schema-preview"},s.createElement(c.Z,{variant:"contained",color:"primary","data-testid":"save-schema-button"},"Submit")))),s.createElement(p.Z,null)):s.createElement("div",null)}}const Z=(0,d.EN)(g)}}]);
//# sourceMappingURL=SchemaEditor.js.map